---
title: "Class06 Interactive Session Section 1B"
author: "Madeline R. Luth"
date: "4/19/2019"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```
First install the Bio3d package. Should realistically install this in the console so it is permanently available, rather than re-installing each time.
```{r}
install.packages("bio3d")
```
```{r}
# Can you improve this analysis code?
library(bio3d)
s1 <- read.pdb("4AKE")  # kinase with drug
s2 <- read.pdb("1AKE")  # kinase no drug
s3 <- read.pdb("1E4Y")  # kinase with drug
s1.chainA <- trim.pdb(s1, chain="A", elety="CA")
s2.chainA <- trim.pdb(s2, chain="A", elety="CA")
s3.chainA <- trim.pdb(s3, chain="A", elety="CA")
#Had to fix a copy-paste error for s3
s1.b <- s1.chainA$atom$b
s2.b <- s2.chainA$atom$b
s3.b <- s3.chainA$atom$b
plotb3(s1.b, sse=s1.chainA, typ="l", ylab="Bfactor")
plotb3(s2.b, sse=s2.chainA, typ="l", ylab="Bfactor")
plotb3(s3.b, sse=s3.chainA, typ="l", ylab="Bfactor")
```
The code works but would be much better as a function to eliminate redundancy/excess typing.

##Q1. What type of object is returned from the read.pdb() function?
This function accesses the structure for the specified protein from the PDB database.The object that is returned is a list of elements about the protein.

Text in the R console says the following if working:

"Note: Accessing on-line PDB file
  Note: Accessing on-line PDB file
   PDB has ALT records, taking A only, rm.alt=TRUE
  Note: Accessing on-line PDB file"

Will also give some summary information from the PDB file, i.e. # of atoms, length, etc.  
  
##Q2. What does the trim.pdb() function do?
From the package documentation, this function will trim residues and/or filter out structures from a PDB object. Returns a PDB object with specified residues, chains, and other structures removed. (Makes a subset from the larger object.)

##Q3. What input parameter would turn off the marginal black and grey rectangles in the plots and what do they represent in this case?
From documentation of plotb3 command, i.e. "Plots with marginal SSE annotation"
Take out the sse command to remove this object. The rectangles are the classic schematic representation/annotation of secondary structure elements (sse). Alpha helices/beta strands, etc.

##Q4. What would be a better plot to compare across the different proteins?
Would be much better to plot them on the same graph. 

##Q5. Which proteins are more similar to each other in their B-factor trends. How could you quantify this? HINT: try the rbind(), dist() and hclust() functions together with a resulting dendrogram plot. Look up the documentation to see what each of these functions does.
```{r}
hc <- hclust( dist( rbind(s1.b, s2.b, s3.b) ) )
plot(hc)
```
Based on the dendrogram plot, s2.b and s3.b are more similar to each other in their B-factor trends than they are to s1.b. 

##Q6. How would you generalize the original code above to work with any set of input protein structures?
Reduce to working snippets before creating the full body of the function.
Due by 1pm on Friday

```{r}
s1.chainA$atom$b
```

